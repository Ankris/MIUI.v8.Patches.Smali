appfile <Settings.apk>;

# Show/Hide search in notification panel in Settings
replaceinfile "%smali%/com/android/settings/MiuiStatusBarSettings.smali"    	"instance fields" 																					"instance fields \n.field private mEnableSearch:Landroid/preference/CheckBoxPreference;\n";
replaceinmethod "%smali%/com/android/settings/MiuiStatusBarSettings.smali" 	".method public onCreate(Landroid/os/Bundle;)V" 															"return-void" 					"const-string v0, "search_enabled"\n    invoke-virtual {p0, v0}, Lcom/android/settings/MiuiStatusBarSettings;->findPreference(Ljava/lang/CharSequence;)Landroid/preference/Preference;\n    move-result-object v0\n    check-cast v0, Landroid/preference/CheckBoxPreference;\n    iput-object v0, p0, Lcom/android/settings/MiuiStatusBarSettings;->mEnableSearch:Landroid/preference/CheckBoxPreference;\n    return-void";
replaceinmethod "%smali%/com/android/settings/MiuiStatusBarSettings.smali" 	".method public onPreferenceTreeClick(Landroid/preference/PreferenceScreen;Landroid/preference/Preference;)Z" 	".prologue"					".prologue \n    iget-object v0, p0, Lcom/android/settings/MiuiStatusBarSettings;->mEnableSearch:Landroid/preference/CheckBoxPreference;\n    if-ne p2, v0, :next_pref\n    invoke-virtual {v0}, Landroid/preference/CheckBoxPreference;->isChecked()Z\n    move-result v1\n    invoke-static {v1}, Ljava/lang/String;->valueOf(Z)Ljava/lang/String;\n    move-result-object v1\n    const-string v0, "persist.sys.showsearch"\n    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V\n    invoke-super {p0, p1, p2}, Lcom/android/settings/SettingsPreferenceFragment;->onPreferenceTreeClick(Landroid/preference/PreferenceScreen;Landroid/preference/Preference;)Z\n    move-result v0\n    return v0\n    :next_pref";
replaceinmethod "%smali%/com/android/settings/MiuiStatusBarSettings.smali" 	".method public onResume()V" 																		"return-void"					"const-string v0, "persist.sys.showsearch"\n    const/4 v1, 0x1\n    invoke-static {v0, v1}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z\n    move-result v1\n    iget-object v0, p0, Lcom/android/settings/MiuiStatusBarSettings;->mEnableSearch:Landroid/preference/CheckBoxPreference;\n    invoke-virtual {v0, v1}, Landroid/preference/CheckBoxPreference;->setChecked(Z)V\n    return-void";
replaceinfile 	   "%res%/xml/key_settings.xml"    							"<CheckBoxPreference android:persistent="false" android:title="@string/search_settings" android:summary="@string/whetstone_level_reboot" android:key="search_enabled" />\n</PreferenceCategory>\n</PreferenceScreen>" 						"</PreferenceCategory>\n</PreferenceScreen>"
